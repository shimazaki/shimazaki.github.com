<!--?xml version="1.0" encoding="UTF-8"?--><!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml">  <head>    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />    <title>Testing Julia for Analysis of Neural Signals</title>    <link href="../css/tool.css" rel="stylesheet" />    <script type="text/javascript" src="http://www.google-analytics.com/urchin.js"></script> <script type="text/javascript">_uacct = "UA-745872-1";urchinTracker();</script> </head>  <body>    <div style="text-align: right;"><a href="../../index.html">Homepage</a> <br />    </div>    <h2>Testing Julia for Analysis of Neural Signals<br />    </h2>    This page explores possibilities of the new language Julia [<a href="julialang.org">julialang.org</a>]    for neural signal analyses. Hope is that it provides faster, user-friendly,    web-centric alternative to the conventional Matlab programing. <br />    <h3> Benchmark test</h3>    <meta />    Comparison of Julia and Matlab by just a simple for-loop. <br />    Julia<br />    <pre><code>tic(); for i=1:1e8; 1+1; end; toc()<br />elapsed time: 0.22376203536987305 seconds</code><br /></pre>    Matlab<br />    <pre><code>tic; for i=1:1e8, 1+1; end; toc;<br />Elapsed time is 3.191013 seconds.</code>    </pre>    Thus, the Julia is very much promising!<br />    <br />    <meta charset="utf-8" />    <span style="color: rgb(0, 0, 0); font-family: arial, sans-serif; font-size: 13px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 18px; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); display: inline !important; float: none; ">The
      authors of the Julia say the reason why the Julia is fast and simple is      its type system and multiple-dispatch. The input-output variables carry      type information like C/Java, which makes the code fast. Like Matlab,      however, you do not need to declare the types always. With the      multiple-dispatch, functions with different types of input arguments can      be defined using the same name. Combination of the two features makes the      code fast and simple. However, this means we need to pay a little      attention to types of the variables when they are used. For example,      different operations + are called for 1+1 and 1+1.0, and they can behave      differently if you define as such.</span><br />    <br />    <h3>Density Estimation</h3>    <p>Estimation of a probability density function from sampled data is often      fundamental in statistical analysis. There are parametric and      non-parametric approaches. Here we consider non-parametric methods. The      most popular non-parametric methods are a histogram and kernel density      estimation method. Here we consider the kernel density estimation and its      optimization. </p>    <p>Data generation. Generate exponentially distributed data. </p>    <pre><code># Datadata = -log(rand(300,1))</code></pre>    <p></p>    Using function definition of Julia lang<br />    <pre><code># Gauss functiongauss(x,w) = 1/sqrt(2.0*pi)./w.*exp(-x.^2/2.0./w.^2) </code><br /></pre>    <p>the kernel density estimator is defined as </p>    <pre><code>mean(gauss(x - data,w))</code></pre>    <p>where <code>x</code> is the point of estimation. To obtain the Gauss      function, a built-in gamma function may be used.<br />    </p>    <p>Use of comprehensions is powerful to create an array of function returns.<br />    </p>    <p>      <meta charset="utf-8" />    </p>    <pre>[mean(gauss(x - data,w)) | x = linspace(-1.0,3.0,100), w = .1]  <br /></pre>    <p>Summary</p>    <pre><code># Datadata = -log(rand(300,1))</code><br /><code># Gauss functiongauss(x,w) = 1/sqrt(2.0*pi)./w.*exp(-x.^2/2.0./w.^2) </code><br /># Density estimation<br />xs = linspace(-1.0,3.0,100)<br />ys = [mean(gauss(x - data,w)) | x = xs, w = .2]plot(xs, ys)</pre>    <p> </p>    <h4></h4>    <pre><img title="kde" alt="kde" src="density_estimation_julia.png" /></pre>    <h4>Bandwidth optimization<br />    </h4>    <p><code></code>The kernel density estimation depends on the choice of      bandwidth. It is possible to select an optimal bandwidth according to the      data. The optimal bandwidth is given by the one that minimizes the      following formula *<br />    </p>    <p><img title="sskernel" alt="sskernel" src="../sskernel/2d_cost.gif" /></p>    <p>where k_w is a kernel function with a bandwidth w. Here we consider the      gauss kernel. This formula can be further simplified for a symmetric      kernel. In addition, an explicit compacted formula is available for the      gauss kernel function (see ref *). Here for simplicity and generality we      compute the above formula.  <br />    </p>    <p>To compute the above formula, we consider the sum of the gauss kernel      function over the data points<br />    </p>    <pre><code></code><code>[sum([sum(gauss(x - data, w)) | x = data])</code> | w=0.1]<br /></pre>    <p>if a bandwidth is 0.1. <br />    </p>    Using the above expression, the formula is written as    <pre><code></code><code>c(w) = sum([sum(gauss(x-data,sqrt(2)*w))-2.0*sum(gauss(x-data,w))+2.0*gauss(0,w)| x = data]) </code><br /></pre>    We compute the cost functions for different bandwidths. Here the <br />    <pre># Bandwidths searched<br />ws = linspace(.01,0.5,50)<br /># Cost function<br />cs = <code>[c(w) | w=ws]</code></pre>    We want to obtain w that minimizes this formula. Currently, the Julia's min    function does not return the index of the minimum element. There are    different ways. Here the we use the    <meta charset="utf-8" />    <span style="color: black; font-family: Georgia,Arial,sans-serif; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: 23px; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; background-color: white; display: inline ! important; float: none;">"ternary
      operator" ? </span>to obtain the optimal bandwidth. It is useful as a    short if-clause.     <pre><code></code>cmin = c[1]<br />idx = 1<br /><br />for i = 1: length(c)<br />	idx = c[i] &lt; cmin ? i : idx	cmin = c[i] &lt; cmin ? c[i] : cmin<br />end<br /><br />wopt = ws[idx]<br /></pre>    We will use wopt as the optimal bandwidth of kernel density estimation.<br />    <br />    Summary of the Gauss kernel bandwidth optimization<br />    <pre># Data<br />data = -log(rand(400,1))<br /><br /># Definition of Gauss kernel<br /><code>gauss(x,w) = 1/sqrt(2.0*pi)./w.*exp(-x.^2/2.0./w.^2) <br /><br /></code># Bandwidths searched<br />ws = linspace(.01,0.5,50)<br /># Cost function<br /><code>c(w) = sum([sum(gauss(x-data,sqrt(2)*w))-2.0*sum(gauss(x-data,w))+2.0*gauss(0,w)| x = data])</code><br />cs = <code>[c(w) | w=ws]</code><br /># Plot the cost function<br />plot(ws,cs) <br /><br /># Select the optimal bandwidth<br />cmin = cs[1]<br />idx = 1<br />for i = 1: length(cs)<br />	idx = cs[i] &lt; cmin ? i : idx	cmin = cs[i] &lt; cmin ? cs[i] : cmin<br />end<br />wopt = ws[idx]<br /># Plot the optimized density estimation<br />xs = linspace(-1.0,3.0,100)<br />ys = [mean(gauss(x - data,w)) | x = xs, w = wopt]plot(xs, ys)<br /></pre>    <pre><img style="width: 519px; height: 455px;" title="kernel_optimization" alt="kernel_optimization"src="1_cost_fun.png" /><br /><imgstyle="width: 519px; height: 455px;"title="kernel_optimization"alt="kernel_optimization"src="2_opt_kde.png" /><br /><br /><br /></pre> <br />    <br />    *    <meta charset="utf-8" />    <strong style="color: rgb(0, 0, 0); font-family: 'Times New Roman', Times, serif; font-style: normal; font-variant: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(236, 233, 216); font-size: medium; "><span        class="Apple-converted-space"> </span>Shimazaki
      H. and Shinomoto S., Kernel Bandwidth Optimization in Spike Rate      Estimation<span style="font-style: italic;"><br />      </span><em>Journal of Computational Neuroscience</em><span class="Apple-converted-space"> </span>(2010)
      Vol. 29 (1-2) 171-182</strong><span style="color: rgb(0, 0, 0); font-family: 'Times New Roman', Times, serif; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(236, 233, 216); font-size: medium; display: inline !important; float: none; "><span        class="Apple-converted-space">      </span>[</span><span class="style27" style="color: rgb(255, 0, 0); font-weight: bold; font-family: 'Times New Roman', Times, serif; font-style: normal; font-variant: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(236, 233, 216); font-size: medium; ">Open
      Access</span><span style="color: rgb(0, 0, 0); font-family: 'Times New Roman', Times, serif; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(236, 233, 216); font-size: medium; display: inline !important; float: none; ">:<span        class="Apple-converted-space"> </span></span><a      href="http://www.springerlink.com/content/g22785288648l239/fulltext.pdf"      onclick="javascript:urchinTracker ('/downloads/sskernel.pdf');"      style="font-family: 'Times New Roman', Times, serif; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(236, 233, 216); font-size: medium; ">PDF</a><span      style="color: rgb(0, 0, 0); font-family: 'Times New Roman', Times, serif; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(236, 233, 216); font-size: medium; display: inline !important; float: none; ">,<span        class="Apple-converted-space"> </span></span><a      href="http://dx.doi.org/10.1007/s10827-009-0180-4"      onclick="javascript:urchinTracker ('/downloads/sskernel.pdf');"      style="font-family: 'Times New Roman', Times, serif; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(236, 233, 216); font-size: medium; ">LINK</a><span      style="color: rgb(0, 0, 0); font-family: 'Times New Roman', Times, serif; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: 2; text-align: -webkit-auto; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-size-adjust: auto; -webkit-text-stroke-width: 0px; background-color: rgb(236, 233, 216); font-size: medium; display: inline !important; float: none; ">]</span><br />    <br />     <a href="../../index.html"></a><a href="https://plus.google.com/103949286156674481154?rel=author">Profile
      in Google+　</a>    <p><br />    </p>    <p><br />    </p>    <p> <br />    </p>  </body></html>