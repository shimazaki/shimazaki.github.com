<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
    <meta content="kernel density estimation,カーネル密度推定,直方图,直方图区间优化,核带宽优化" name="keywords" />
    <title>Kernel Bandwidth Optimization</title>
    <link href="css/tool.css" rel="stylesheet" />
    <script type="text/javascript" src="kernel.js"></script>
    <script type="text/javascript" src="http://www.google-analytics.com/urchin.js">
</script>
    <script type="text/javascript">_uacct = "UA-745872-1"; urchinTracker();</script>
    <!--[if IE]><script type="text/javascript" src="excanvas.js"></script><![endif]-->
    <!-- Local Javascript -->
    <!-- saved from url=(0013)about:internet -->
    <!-- Facebook Metadata -->
    <meta content="Kernel Bandwidth Optimization" property="og:title" />
    <meta content="H. Shimazaki" property="og:site_name" />
    <meta content="http://web.mit.edu/hshimaza/www/res/sskernel/shimazaki_shinomoto_optmized_2d_kde.png"
      property="og:image" />
    <style type="text/css">
<!--
.style26 {	background-color: #669966;
	border-bottom-color: #663366;
	text-decoration: none;
	font-size: small;
	color: #FFFFFF;
}
.style27 {
	color: #FF0000;
	font-weight: bold;
}
.style28 {background-color: #669966; border-bottom-color: #663366; text-decoration: none; font-size: small; color: #FFFFFF; font-weight: bold; }
body,td,th {
	font-family: Times New Roman, Times, serif;
}
.style29 {color: #FFFFFF}
.style33 {
	font-size: x-large;
	font-weight: bold;
}
.style36 {font-size: xx-large}
.style37 {color: #DDDDDD}
.style44 {font-family: "Times New Roman", Times, serif}
.style43 {color: #CCCCCC}
-->
</style>
  </head>
  <body>
    <a id="Top" name="Top"></a>
    <!-- BEGIN CONTENTS -->
    <div id="Contents">
      <table width="180" cellspacing="2" cellpadding="0" border="0">
        <tbody>
          <tr>
            <td valign="top" height="22"> </td>
          </tr>
          <tr>
            <td valign="top" height="22"><a class="style9" href="#Top">KERNEL
                METHOD </a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="#WebApp">- Web Application</a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="#WebApp">- </a><a class="style9"
                href="#Method">Optimization
                Method</a><a class="style22 style23" target="_parent" href="../index.html"></a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="#WebApp">- </a><a class="style9"
                href="#Ref">Original
                paper </a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="#WebApp">- </a><a class="style9"
                href="#FAQ">FAQ</a><a
                class="style9"
                href="#Scheme"></a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="#WebApp">- </a><a class="style9"
                href="#Code">Matlab
                Code </a><a class="style9" href="#Code"></a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="#WebApp">- </a><a class="style9"
                href="#Presentation">Presentation</a><a
                class="style9"
                href="#Code"></a></td>
          </tr>
          <tr>
            <td valign="top"> </td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="#WebApp"></a><a class="style9"
                href="#Links">Links</a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="histogram.html">- Histogram
                Optimization</a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="ssloglin/index.html">-
                Dynamic Interactions </a></td>
          </tr>
          <tr>
            <td valign="top"><a class="style9" href="../index.html">- HOME Page</a></td>
          </tr>
          <tr>
            <td valign="top"> </td>
          </tr>
          <tr>
            <td valign="top"><span class="style9">Tweet by author </span> <iframe
                width="180"
                scrolling="no"
                height="260"
                frameborder="0"
                align="left"
                marginwidth="0"
                marginheight="0"
                src="../tweet.html"></iframe>
            </td>
          </tr>
          <tr>
            <td valign="top" height="19"> </td>
          </tr>
          <tr>
            <td valign="top" height="19"><img alt="H Shimazaki" src="http://www.gravatar.com/avatar/0c0e1f9cb353f991e194574730d4599d?s=100" /><span
                class="style4"><span
                  class="style1"><br />
                </span></span>This page is managed by<br />
              <span class="style4"><span class="style1"><a class="style22" target="_parent"
                    href="../reroute.html">H.
                    Shimazaki, PhD</a></span></span></td>
          </tr>
          <tr>
            <td valign="top" height="19"> </td>
          </tr>
          <tr>
            <td valign="top" height="50">
              <!-- AddThis Button BEGIN -->
              <div align="right" class="addthis_toolbox addthis_default_style">
                <a addthis:description="This page INSTANTLY generates an optimized Kernel Density Estimate of YOUR DATA."
                  class="addthis_button_compact"
                  href="http://www.addthis.com/bookmark.php?v=250&amp;username=xa-4bdcb0477f5f1b02">Share</a>
                <span class="addthis_separator">|</span>
                <a addthis:description="This page INSTANTLY generates an optimized Kernel Density Estimate of YOUR DATA."
                  class="addthis_button_delicious"></a>
                <a addthis:description="This page INSTANTLY generates an optimized Kernel Density Estimate of YOUR DATA."
                  class="addthis_button_myspace"></a>
                <a addthis:description="This page INSTANTLY generates an optimized Kernel Density Estimate of YOUR DATA."
                  class="addthis_button_google"></a>
                <a addthis:description="This page INSTANTLY generates an optimized Kernel Density Estimate of YOUR DATA."
                  class="addthis_button_facebook"></a></div>
              <script src="http://s7.addthis.com/js/250/addthis_widget.js#username=xa-4bdcb0477f5f1b02"
type="text/javascript"></script>
              <!-- AddThis Button END --> </td>
          </tr>
          <tr>
            <td valign="top"> <br />
            </td>
          </tr>
          <tr>
          </tr>
          <tr>
            <td valign="top">
              <!-- FACEBOOK -->
              <script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
              <div data-font="arial" data-show-faces="true" data-width="175" data-send="false"
                data-href="http%3A%2F%2F2000.jukuin.keio.ac.jp%2Fshimazaki%2Fres%2Fkernel.html"
                class="fb-like"></div>
            </td>
          </tr>
          <tr>
            <td valign="top"> <br />
            </td>
          </tr>
        </tbody>
      </table>
      <br />
    </div>
    <!-- END of CONTENTS -->
    <table width="700" height="140" cellspacing="0" cellpadding="5" bordercolor="#FFFFFF"
      border="0"
      bgcolor="#330033">
      <tbody>
        <tr>
          <td nowrap="nowrap" height="134" bgcolor="#FFFFFF" background="icons/itoh_jakuchu4_2.jpg"
            bordercolor="#FFFFFF">
            <div align="right"><span class="style29 style13 style33"><span class="style13 style36"><span
                    class="style29">Kernel
                    Bandwidth Optimization</span></span></span><br />
            </div>
            <br />
            <div align="right" class="style29"><span><strong><em><br />
                    Web application for optimizing kernel density estimate of
                    your data </em> </strong></span> </div>
          </td>
        </tr>
      </tbody>
    </table>
    <table width="700" cellspacing="0" cellpadding="0" border="0">
      <tbody>
        <tr>
          <td nowrap="nowrap" height="" bgcolor="#330033" bordercolor="#FFFFFF">
            <div align="right"><a class="style37" href="histogram.html"><strong>Histogram
                  Optimization</strong></a> <span class="style29">|</span> <a
                class="style37"
                href="kernel.html">Kernel
                Optimization</a> <span class="style29">|</span><span class="style23 style38">
                <a class="style37" href="ssloglin/index.html">Dynamic
                  Interactions</a></span> <span class="style29">|</span><span class="style43 style23">
                Last Update
                <!-- #BeginDate format:IS1m -->2012-05-15  12:48<!-- #EndDate -->
              </span> <span class="style29">|</span> </div>
          </td>
        </tr>
      </tbody>
    </table>
    <br />
    <table width="700" cellspacing="0" cellpadding="0" border="0">
      <tbody>
        <tr>
          <td width="376" nowrap="nowrap" height="24"> <br />
          </td>
          <td width="120" nowrap="nowrap"><!-- FACEBOOK --> <iframe scrolling="no"
              frameborder="0"
              style="border:none; overflow:hidden; width:110px; height:20px"
              allowtransparency="true"
              src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2F2000.jukuin.keio.ac.jp%2Fshimazaki%2Fres%2Fkernel.html&amp;layout=button_count&amp;show_faces=false&amp;width=180&amp;action=like&amp;colorscheme=dark"></iframe>
          </td>
          <td width="80" nowrap="nowrap"><!-- Google -->
            <!-- Place this tag where you want the +1 button to render -->
            <g:plusone size="medium"></g:plusone>
            <!-- Place this render call where appropriate -->
            <script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script></td>
          <td width="80" nowrap="nowrap"><!-- TWITTER -->
            <a data-related="H_Shimazaki:Japanese tweets from author." data-via="statneuro"
              data-count="horizontal"
              class="twitter-share-button"
              href="http://twitter.com/share">
              Tweet</a>
            <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script></td>
        </tr>
      </tbody>
    </table>
    <br />
    <table width="700" cellspacing="0" cellpadding="0" border="0">
      <tbody>
        <tr>
          <td height="24" bgcolor="#ECE9D8">
            <p align="center" class="style4 "><strong><a href="http://www.springerlink.com/content/g22785288648l239/fulltext.pdf"></a>
                Shimazaki and Shinomoto, <em> Journal of Computational
                  Neuroscience, </em>2010, 29 (1-2) 171-182</strong> <strong><a
                  href="http://www.springerlink.com/content/g22785288648l239/fulltext.pdf"><img
                    width="40"
                    height="15"
                    border="0"
                    align="bottom"
                    src="icons/pdf.gif" /></a></strong></p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2><a id="WebApp" name="WebApp"></a>Optimize Density Profile of Your Data</h2>
    <table width="700" height="138" cellpadding="10" border="0" bgcolor="#ECE9D8">
      <tbody>
        <tr>
          <td>
            <div align="center">Web Application for Kernel Bandwidth
              Optimization (Ver. 0.4) </div>
            <form id="DATAFORM" name="DATAFORM"> <strong>1. Copy&amp;Paste your
                data</strong>
              <div align="center"> <textarea onkeyup="PostData();" wrap="off" cols="65"
                  rows="9"
                  name="TEXT">
4.37 3.87 4.00 4.03 3.50 4.08 2.25 4.70 1.73 4.93 1.73 4.62
3.43 4.25 1.68 3.92 3.68 3.10 4.03 1.77 4.08 1.75 3.20 1.85
4.62 1.97 4.50 3.92 4.35 2.33 3.83 1.88 4.60 1.80 4.73 1.77
4.57 1.85 3.52 4.00 3.70 3.72 4.25 3.58 3.80 3.77 3.75 2.50
4.50 4.10 3.70 3.80 3.43 4.00 2.27 4.40 4.05 4.25 3.33 2.00
4.33 2.93 4.58 1.90 3.58 3.73 3.73 1.82 4.63 3.50 4.00 3.67
1.67 4.60 1.67 4.00 1.80 4.42 1.90 4.63 2.93 3.50 1.97 4.28
1.83 4.13 1.83 4.65 4.20 3.93 4.33 1.83 4.53 2.03 4.18 4.43
4.07 4.13 3.95 4.10 2.72 4.58 1.90 4.50 1.95 4.83 4.12</textarea><br />
                <strong>
                  <div>
                    <div align="right"> <input type="reset" value="Reset" name="reset" />
                    </div>
                  </div>
                </strong></div>
            </form>
            <p><strong>2.</strong> <input type="button" language="JavaScript" onclick="PostData(); raster(DATA); density(); t=xaxis(); alert('The optimal kernel width is '  + optw.toPrecision(3)); javascript:urchinTracker ('/kernel/optimization');"
                value="PRESS HERE to Calculate the Optimal Bandwidth"
                name="Button" />
            </p>
            <div align="center"> <canvas height="300" width="500" id="Canvas"></canvas>
              <canvas height="20" width="500" id="Raster"></canvas> </div>
            <p></p>
            <p><strong>3.</strong> <input type="button" value="Data Sheet of the Optimized Density Estimation"
                onclick="Results_In_Window(); javascript:urchinTracker ('/kernel/datasheet');"
                name="button" />
            </p>
            <hr />
            <p>* The Gauss kernel density was used. Its standard deviation is
              optmized. </p>
            <p>* Feel safe. The data is processed on your own computer (NEVER
              transferred to our server). </p>
            <p>* This web application uses the HTML5 Canvas technology.</p>
            <p>ver 0.4 (101231) accelarating computation by excluding &gt;5 std
              samples. </p>
            <div align="center">Web Application for Kernel Bandwidth
              Optimization © 2009-2011Hideaki Shimazaki</div>
          </td>
        </tr>
      </tbody>
    </table>
    <p><br />
    </p>
    <h2><a id="Method" name="Method"></a>Kernel Bandwidth Optimization Method </h2>
    <table width="700" height="138" cellpadding="0" border="0" bgcolor="#ECE9D8">
      <tbody>
        <tr>
          <td>
            <blockquote>
              <p class="style4"><strong>I.</strong> Let <img width="49" height="21"
                  src="sskernel/data.gif" />
                be your data. Let the kernel with bandwidth <img width="11" height="9"
                  src="sskernel/w.gif" />
                be <img width="35" height="16" align="bottom" src="sskernel/kernel.gif" />.</p>
              <span class="style4"><strong>II.</strong></span> <span class="style4">Compute
                a formula, </span>
              <div align="center" class="style4">
                <!-- MATH
 \begin{displaymath}\bar{k} \equiv \frac{1}{N} \sum_{i=1}^{N} k_i \mbox{, and }  \displaystyle s^2 \equiv \frac{1}{N-1} \sum_{i=1}^{N} (k_i-\bar{k})^2.
\end{displaymath} --> <img width="384" height="51" src="sskernel/sskernel_costfunction.gif" /></div>
              <p><span class="style4"><strong>III.</strong></span> <span class="style4">Find
                  <img width="17" height="13" src="sskernel/w_star.gif" /> that
                  minimizes <img align="bottom" src="sskernel/C.gif" /></span>
                .</p>
              <p>From the observed data only, the method estimates a bandwidth
                that minimizes expected L2 loss between the kernel estimate and
                an unknown underlying density function. An assumption made here
                is merely that samples are drawn from the density independently
                each other. </p>
              <div align="center" class="style4"></div>
            </blockquote>
          </td>
        </tr>
      </tbody>
    </table>
    <p> </p>
    <h3><a id="Ref" name="Ref"></a>Original paper </h3>
    <table width="700" height="36" cellpadding="10" border="0" bgcolor="#ECE9D8">
      <tbody>
        <tr>
          <td height="30">
            <p>From the observed data only, the method estimates a binwidth that
              minimizes expected L2 loss between the kernel density estimate and
              an unknown underlying density function. An assumption made here is
              merely that samples are drawn from the density independently each
              other.</p>
            <p>The method was developed in collaboration with Prof. Shinomoto in
              Kyoto University. </p>
            <p><strong><img width="40" height="15" border="0" align="bottom" src="icons/pdf.gif" />
                Shimazaki H. and Shinomoto S., Kernel Bandwidth Optimization in
                Spike Rate Estimation. <em> Journal of Computational
                  Neuroscience</em> (2010) Vol. 29 (1-2) 171-182</strong>
              doi:10.1007/s10827-009-0180-4 [<span class="style27">Open Access</span>:
              <a onclick="javascript:urchinTracker ('/downloads/sskernel.pdf');"
                href="http://www.springerlink.com/content/g22785288648l239/fulltext.pdf">PDF</a>,
              <a onclick="javascript:urchinTracker ('/downloads/sskernel.pdf');"
                href="http://dx.doi.org/10.1007/s10827-009-0180-4">LINK</a>]</p>
            <p><strong><img width="40" height="15" border="0" align="bottom" src="icons/pdf.gif" /></strong>
              <a onclick="javascript:urchinTracker ('/downloads/sskernel.ppt');"
                target="_blank"
                href="ppt/histogram-kernel_optimization.pdf"><strong>Presentation
                  Slides</strong></a> </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p> </p>
    <h2><a id="FAQ" name="FAQ"></a>FAQ</h2>
    <table width="700" height="62" cellpadding="10" border="0" bgcolor="#ECE9D8">
      <tbody>
        <tr>
          <td height="58">
            <p>Q. Is the method applicable to probability density estimation?</p>
            <p>A. Yes. </p>
            <hr />
            <p class="style4">Q. You provide a histogram optimization method,
              too. Which of the methods, kernel and histogram, do you recommend
              for density estimation. </p>
            <p><span class="style4">A.</span> Kernel density estimation is
              generally recommended. See <a href="#Ref">our original paper</a>
              for comparison of the methods. </p>
            <hr />
            <p>Q. Is it different from the least squares cross-validation
              method?</p>
            <p>A. Yes. The above formula was derrived under a Poisson point
              process assumption [see <a href="#Ref">our original paper</a>],
              not by the cross-validation. As a result, chosen bandwidths by the
              two methods are not identical. </p>
            <hr />
            <p>Q. Can I use the method for the 2-dimensional density estimation?</p>
            <p>A. Yes. The same optimization formula can be used in 2-d density
              estimation. Specifically, the formula for two dimensional vector
              data <img width="65" height="16" alt="x" src="sskernel/2d_x.gif" />
              is given by </p>
            <p align="center"><img width="435" height="53" alt="2d kernel cost"
                src="sskernel/2d_cost.gif" /></p>
            <p align="left">Here the kernel function is defined in 2-dimension.
              For example, the 2-d (symmetric) Gauss kernel is defined as</p>
            <p align="center"> <img width="201" height="39" src="sskernel/2d_gauss.gif" /></p>
            <p align="left">where <img width="88" height="18" src="sskernel/2d_distance.gif" />.
            </p>
            <p align="left"> An example of the optimized 2d kernel density
              estimate is displayed below. </p>
            <p align="center"><img width="287" height="125" src="sskernel/shimazaki_shinomoto_optmized_2d_kde.png" /></p>
            <p align="left">Here are the example matlab code <a onclick="javascript:urchinTracker ('/downloads/Demo_sskernel2d.m');"
                href="code/sskernel2d_demo.m">sskernel2d_demo.m</a>
              and <a href="code/oldfaithful.txt">data</a>. </p>
            <p align="left">Note: if you have two dimensional variables with
              different dynamic ranges, it should be careful to use the
              one-parameter 2-d kernel. It would be recommended to either i)
              optimize two-parameters kernel, or ii) optimize the one-parameter
              kernel using the standardized data, for example, by dividing the
              data by standard deviations of each component. </p>
            <hr />
            <p align="left"><span class="style4">Q. Is the variable bandwidth
                kernel available?</span></p>
            <p align="left"><span class="style4">A. A matlab code for the
                Variable Kernel Bandwidth Optimization in the original paper is
                under preparation. </span></p>
            <hr />
            <p>Q. Can I compare the goodness-of-fit of kernel density estimate
              with that of a histogram?</p>
            <p>The definition of the cost function is different in the two
              papers (2007 and 2010). To compare the cost function of a
              histogram with the cost function of a kernel, please adjust the
              histogram cost function as T*C(D)+K^2/T, where K is the total
              number of samples, and T is the observation length. </p>
            <p align="left"> </p>
            <hr />
            The FAQ includes my (HS) opinion. They are not opinions neither by
            my collaborators nor institutions I belong to. <span class="style22"><a
                class="style22"
                href="#Top"></a></span>
          </td>
        </tr>
      </tbody>
    </table>
    <p> </p>
    <h2><a id="Code" name="Code"></a>Code </h2>
    <table width="700" height="62" cellpadding="10" border="0" bgcolor="#ECE9D8">
      <tbody>
        <tr>
          <td height="58">
            <p class="style4">Matlab code: <a href="code/sskernel.m">sskernel.m</a></p>
            <p class="style4">Function `sskernel' returns optimal bandwidth
              (standard deviation) of the Gauss kernel function used in kernel
              density estimation.</p>
            <p class="style4">optW = sskernel(x); ksdensity(x,'width',optW);</p>
            <p class="style4"> Statitics Toolbox is required to execute
              ksdensity. If it is not available, define the Gauss function as<br />
              `Gauss = @(s,w) 1/sqrt(2*pi)/w*exp(-s.^2/2/w^2);'. Computing
              `mean( Gauss(x-s,optW) )' provides kernel estimate at s. <br />
            </p>
            <p class="style4"><br />
            </p>
            <p class="style4">Julia code: Please visit <a href="file:///Users/hideaki/Dropbox/www/res/janes/index.html">here</a>.
              <br />
            </p>
          </td>
        </tr>
      </tbody>
    </table>
    <h2> </h2>
    <h2><a id="Presentation" name="Presentation"></a>Presentation</h2>
    <table width="700" height="62" cellpadding="10" border="0" bgcolor="#ECE9D8">
      <tbody>
        <tr>
          <td height="58">
            <p align="center" class="style4"> <object width="670" height="600"
                style="outline:none;"
                data="http://d1.scribdassets.com/ScribdViewer.swf"
                type="application/x-shockwave-flash"
                name="doc_62829"
                id="doc_62829">
                <param value="http://d1.scribdassets.com/ScribdViewer.swf" name="movie" />
                <param value="opaque" name="wmode" /> <param value="#ffffff" name="bgcolor" />
                <param value="true" name="allowFullScreen" /> <param value="always"
                  name="allowScriptAccess" />
                <param value="document_id=46152083&amp;access_key=key-nlr8jr7whc25spzh8h0&amp;page=1&amp;viewMode=slideshow"
                  name="FlashVars" />
                <embed width="670" height="600" bgcolor="#ffffff" wmode="opaque"
                  allowfullscreen="true"
                  allowscriptaccess="always"
                  type="application/x-shockwave-flash"
                  src="http://d1.scribdassets.com/ScribdViewer.swf?document_id=46152083&amp;access_key=key-nlr8jr7whc25spzh8h0&amp;page=1&amp;viewMode=slideshow"
                  name="doc_62829"
                  id="doc_62829" />
              </object> </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p> </p>
    <h2><a id="Links" name="Links"></a>Links</h2>
    <table width="700" height="36" cellpadding="10" border="0" bgcolor="#ECE9D8">
      <tbody>
        <tr>
          <td height="30">
            <p>External Links </p>
            <p><a href="http://www.ton.scphys.kyoto-u.ac.jp/%7Eshino/toolbox/english.htm">Other
                applications for analyzing spike data: <strong>SULAB</strong></a>
              ( <a href="http://www.ton.scphys.kyoto-u.ac.jp/%7Eshino/">Prof.
                Shinomoto</a> ) </p>
          </td>
        </tr>
      </tbody>
    </table>
    <p> </p>
    <p> </p>
  </body>
</html>
